
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>SIPS Workflow Â· Cumulus Documentation</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="cnm-workflow.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Documentation</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Home
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../architecture.html">
            
                <a href="../architecture.html">
            
                    
                    Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Deployment
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../deployment/">
            
                <a href="../deployment/">
            
                    
                    How to Deploy Cumulus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../deployment/create_bucket.html">
            
                <a href="../deployment/create_bucket.html">
            
                    
                    Creating an S3 Bucket
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../deployment/iam_roles.html">
            
                <a href="../deployment/iam_roles.html">
            
                    
                    Locating IAMs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../deployment/troubleshoot_deployment.html">
            
                <a href="../deployment/troubleshoot_deployment.html">
            
                    
                    Troubleshooting Deployment
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../workflows/">
            
                <a href="../workflows/">
            
                    
                    What are Cumulus Workflows?
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../workflows/protocol.html">
            
                <a href="../workflows/protocol.html">
            
                    
                    Workflow Protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../tasks.html">
            
                <a href="../tasks.html">
            
                    
                    Workflow Tasks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../workflows/input_output.html">
            
                <a href="../workflows/input_output.html">
            
                    
                    Workflow Input & Ouptut
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../workflows/cumulus-task-message-flow.html">
            
                <a href="../workflows/cumulus-task-message-flow.html">
            
                    
                    Workflow Task Message Flow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../workflows/developing-workflow-tasks.html">
            
                <a href="../workflows/developing-workflow-tasks.html">
            
                    
                    Developing Workflow Tasks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.5.1" data-path="../workflows/lambda.html">
            
                <a href="../workflows/lambda.html">
            
                    
                    Lambda Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.2" data-path="../workflows/docker.html">
            
                <a href="../workflows/docker.html">
            
                    
                    Dockerization
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../workflows/workflow-configuration-how-to.html">
            
                <a href="../workflows/workflow-configuration-how-to.html">
            
                    
                    Workflow Configuration How-to's
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    Additional Cumulus Features
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../data_in_dynamodb.html">
            
                <a href="../data_in_dynamodb.html#cumulus-metadata-in-dynamodb">
            
                    
                    Cumulus Metadata in DynamoDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../data_in_dynamodb.html">
            
                <a href="../data_in_dynamodb.html#backup-and-restore-with-aws">
            
                    
                    DynamoDB Backup and Restore
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../data_in_dynamodb.html">
            
                <a href="../data_in_dynamodb.html#dynamodb-auto-scaling">
            
                    
                    DynamoDB Auto Scaling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../ems_reporting.html">
            
                <a href="../ems_reporting.html">
            
                    
                    EMS Reporting
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <a target="_blank" href="https://nasa.github.io/cumulus-api">
            
                    
                    Cumulus API Docs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../doc_installation.html">
            
                <a href="../doc_installation.html">
            
                    
                    Contributing to documentation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../adding-a-task.html">
            
                <a href="../adding-a-task.html">
            
                    
                    Adding a task
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../upgrade/">
            
                <a href="../upgrade/">
            
                    
                    Upgrade Instructions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../upgrade/1.6.0.html">
            
                <a href="../upgrade/1.6.0.html">
            
                    
                    1.6.0
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../upgrade/1.7.0.html">
            
                <a href="../upgrade/1.7.0.html">
            
                    
                    1.7.0
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../upgrade/1.9.0.html">
            
                <a href="../upgrade/1.9.0.html">
            
                    
                    1.9.0
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <a target="_blank" href="https://github.com/nasa/cumulus/blob/master/CHANGELOG.md">
            
                    
                    Changelog
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../team.html">
            
                <a href="../team.html">
            
                    
                    Team
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Data Cookbook</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="about-cookbooks.html">
            
                <a href="about-cookbooks.html">
            
                    
                    About Cookbooks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="setup.html">
            
                <a href="setup.html">
            
                    
                    Collections, Providers, Schemas, and Rules
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="hello-world.html">
            
                <a href="hello-world.html">
            
                    
                    HelloWorldWorkflow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="sns.html">
            
                <a href="sns.html">
            
                    
                    SNS Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="cnm-workflow.html">
            
                <a href="cnm-workflow.html">
            
                    
                    CNM Workflow
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.5" data-path="sips-workflow.html">
            
                <a href="sips-workflow.html">
            
                    
                    SIPS Workflow
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >SIPS Workflow</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="science-investigator-led-processing-systems-sips">Science Investigator-led Processing Systems (SIPS)</h1>
<p>The Cumulus ingest workflow supports the SIPS workflow. In the following document, we&apos;ll discuss what a SIPS workflow is and how to set one up in a Cumulus instance.</p>
<p>In this document, we assume the user already has a provider endpoint configured and ready with some data to ingest. We&apos;ll be using an S3 provider and ingesting from a MOD09GQ collection.</p>
<h2 id="setup">Setup</h2>
<h4 id="provider">Provider</h4>
<p>We need to have a <a href="setup.html#providers">provider</a> from whom data can be ingested. Our provider is an S3 provider hosted in the <code>cumulus-test-internal</code> bucket.</p>
<p><img src="../images/sips-provider.png" alt=""></p>
<h4 id="collection">Collection</h4>
<p>We need to build a collection. Details on collections can be found <a href="setup.html#collections">here</a>. The following collection will have <code>MOD09GQ</code> as a collection name, <code>006</code> as a version, and is configured to pull PDRs from <code>${bucket}/cumulus-test-data/pdrs</code> in S3 (where <code>${bucket}</code> is configured in the provider).</p>
<pre><code>{
    &quot;queriedAt&quot;: &quot;2018-08-03T16:44:25.919Z&quot;,
    &quot;name&quot;: &quot;MOD09GQ&quot;,
    &quot;version&quot;: &quot;006&quot;,
    &quot;process&quot;: &quot;modis&quot;,
    &quot;sampleFileName&quot;: &quot;MOD09GQ.A2017025.h21v00.006.2017034065104.hdf&quot;,
    &quot;dataType&quot;: &quot;MOD09GQ&quot;,
    &quot;granuleIdExtraction&quot;: &quot;(MOD09GQ\\..*)(\\.hdf|\\.cmr|_ndvi\\.jpg)&quot;,
    &quot;createdAt&quot;: 1531324194001,
    &quot;granuleId&quot;: &quot;^MOD09GQ\\.A[\\d]{7}\\.[\\S]{6}\\.006\\.[\\d]{13}$&quot;,
    &quot;provider_path&quot;: &quot;cumulus-test-data/pdrs&quot;,
    &quot;files&quot;: [
          {
              &quot;bucket&quot;: &quot;protected&quot;,
              &quot;regex&quot;: &quot;^MOD09GQ\\.A[\\d]{7}\\.[\\S]{6}\\.006\\.[\\d]{13}\\.hdf$&quot;,
              &quot;sampleFileName&quot;: &quot;MOD09GQ.A2017025.h21v00.006.2017034065104.hdf&quot;,
              &quot;url_path&quot;: &quot;{cmrMetadata.Granule.Collection.ShortName}/{extractYear(cmrMetadata.Granule.Temporal.RangeDateTime.BeginningDateTime)}/{substring(file.name, 0, 3)}&quot;
          },
          {
              &quot;bucket&quot;: &quot;private&quot;,
              &quot;regex&quot;: &quot;^MOD09GQ\\.A[\\d]{7}\\.[\\S]{6}\\.006\\.[\\d]{13}\\.hdf\\.met$&quot;,
              &quot;sampleFileName&quot;: &quot;MOD09GQ.A2017025.h21v00.006.2017034065104.hdf.met&quot;
          },
          {
              &quot;bucket&quot;: &quot;protected-2&quot;,
              &quot;regex&quot;: &quot;^MOD09GQ\\.A[\\d]{7}\\.[\\S]{6}\\.006\\.[\\d]{13}\\.cmr\\.xml$&quot;,
              &quot;sampleFileName&quot;: &quot;MOD09GQ.A2017025.h21v00.006.2017034065104.cmr.xml&quot;
          },
          {
              &quot;bucket&quot;: &quot;public&quot;,
              &quot;regex&quot;: &quot;^MOD09GQ\\.A[\\d]{7}\\.[\\S]{6}\\.006\\.[\\d]{13}_ndvi\\.jpg$&quot;,
              &quot;sampleFileName&quot;: &quot;MOD09GQ.A2017025.h21v00.006.2017034065104_ndvi.jpg&quot;
          }
    ],
    &quot;duplicateHandling&quot;: &quot;replace&quot;,
    &quot;updatedAt&quot;: 1533313794693,
    &quot;url_path&quot;: &quot;{cmrMetadata.Granule.Collection.ShortName}/{substring(file.name, 0, 3)}&quot;,
    &quot;timestamp&quot;: 1533313798525,
    &quot;stats&quot;: {
        &quot;running&quot;: 0,
        &quot;completed&quot;: 0,
        &quot;failed&quot;: 2,
        &quot;total&quot;: 2
    }
}
</code></pre><h4 id="rule">Rule</h4>
<p>Finally, let&apos;s create a <a href="setup.html#rules">rule</a>. In this example we&apos;re just going to create a <code>onetime</code> throw-away rule that will be easy to test with. This rule will kick off the <code>DiscoverAndParsePdrs</code> workflow, which is the beginning of a Cumulus SIPS workflow.</p>
<pre><code>{
    &quot;name&quot;: &quot;s3_provider_rule&quot;,
    &quot;workflow&quot;: &quot;DiscoverAndQueuePdrs&quot;,
    &quot;provider&quot;: &quot;s3_provider&quot;,
    &quot;collection&quot;: {
        &quot;name&quot;: &quot;MOD09GQ&quot;,
        &quot;version&quot;: &quot;006&quot;
    },
    &quot;rule&quot;: {
        &quot;type&quot;: &quot;onetime&quot;
    },
    &quot;state&quot;: &quot;ENABLED&quot;,
    &quot;tags&quot;: [
        &quot;test&quot;
    ]
}
</code></pre><p><strong>Note:</strong> A list of configured workflows exists under the &quot;Workflows&quot; in the navigation bar on the Cumulus dashboard. Additionally, one can find a list of executions and their respective status in the &quot;Executions&quot; tab in the navigation bar.</p>
<h2 id="discoverandqueuepdrs-workflow">DiscoverAndQueuePdrs Workflow</h2>
<p>This workflow will (as the name might suggest) discover PDRs and queue them to be processed. Duplicate PDRs will be dealt with according to the configured duplicate handling setting in the collection.</p>
<ol>
<li>DiscoverPdrs - <a href="https://www.npmjs.com/package/@cumulus/discover-pdrs" target="_blank">npm package</a>, <a href="https://github.com/nasa/cumulus/tree/master/tasks/discover-pdrs" target="_blank">source</a></li>
<li>QueuePdrs - <a href="https://www.npmjs.com/package/@cumulus/queue-pdrs" target="_blank">npm package</a>, <a href="https://github.com/nasa/cumulus/tree/master/tasks/queue-pdrs" target="_blank">source</a></li>
</ol>
<p><img src="../images/sips-discover-and-queue-pdrs-execution.png" alt=""></p>
<p><em>Example configuration for this workflow can be found in the <code>DiscoverAndQueuePdrs</code> object defined in Cumulus core&apos;s <a href="https://github.com/nasa/cumulus/blob/master/example/workflows.yml" target="_blank">example</a></em></p>
<h2 id="parsepdr-workflow">ParsePdr Workflow</h2>
<p>The ParsePdr workflow will parse a PDR, queue the specified granules (duplicates are handled according to the duplicate handling setting) and periodically check the status of those queued granules. This workflow will not succeed until all the granules included in the PDR are successfully ingested. If one of those fails, the ParsePdr worklfow will fail. <strong>NOTE</strong> that ParsePdr may spin up multiple IngestGranule workflows in parallel, depending on the granules included in the PDR.</p>
<ol>
<li>ParsePdr - <a href="https://www.npmjs.com/package/@cumulus/parse-pdr" target="_blank">npm package</a>, <a href="https://github.com/nasa/cumulus/tree/master/tasks/parse-pdr" target="_blank">source</a></li>
<li>QueueGranules - <a href="https://www.npmjs.com/package/@cumulus/queue-granules" target="_blank">npm package</a>, <a href="https://github.com/nasa/cumulus/tree/master/tasks/queue-granules" target="_blank">source</a></li>
<li>CheckStatus - <a href="https://www.npmjs.com/package/@cumulus/pdr-status-check" target="_blank">npm package</a>, <a href="https://github.com/nasa/cumulus/tree/master/tasks/pdr-status-check" target="_blank">source</a></li>
</ol>
<p><img src="../images/sips-parse-pdr.png" alt=""></p>
<p><em>Example configuration for this workflow can be found in the <code>ParsePdr</code> object defined in Cumulus core&apos;s <a href="https://github.com/nasa/cumulus/blob/master/example/workflows.yml" target="_blank">example</a></em></p>
<h2 id="ingestgranule-workflow">IngestGranule Workflow</h2>
<p>The IngestGranule workflow processes and ingests a granule and posts the granule metadata to CMR.</p>
<ol>
<li>SyncGranule - <a href="https://www.npmjs.com/package/@cumulus/sync-granule" target="_blank">npm package</a>, <a href="https://github.com/nasa/cumulus/tree/master/tasks/sync-granule" target="_blank">source</a></li>
<li>ProcessingStep - The processing step does not come from Cumulus core. The &quot;AsterProcess,&quot; &quot;ModisProcess,&quot; and &quot;LegacyProcess&quot; steps in the workflow picture below are examples of custom processing steps.</li>
<li>CmrStep - <a href="https://www.npmjs.com/package/@cumulus/post-to-cmr" target="_blank">npm package</a>, <a href="https://github.com/nasa/cumulus/tree/master/tasks/post-to-cmr" target="_blank">source</a></li>
</ol>
<p><strong>Note:</strong> Hitting CmrStep is not required and can be left out of the processing trajectory if desired (for example, in testing situations).</p>
<p><img src="../images/sips-ingest-granule.png" alt=""></p>
<p><em>Example configuration for this workflow can be found in the <code>IngestGranule</code> object defined in Cumulus core&apos;s <a href="https://github.com/nasa/cumulus/blob/master/example/workflows.yml" target="_blank">example</a></em></p>
<h2 id="summary">Summary</h2>
<p>In this cookbook we went over setting up a collection, rule, and provider for a SIPS workflow. Once we had the setup completed, we looked over the Cumulus workflows that participate in parsing PDRs, ingesting and processing granules, and updating CMR.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="cnm-workflow.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: CNM Workflow">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"SIPS Workflow","level":"2.5","depth":1,"previous":{"title":"CNM Workflow","level":"2.4","depth":1,"path":"data-cookbooks/cnm-workflow.md","ref":"data-cookbooks/cnm-workflow.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"root":"docs","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Cumulus Documentation","gitbook":"*"},"file":{"path":"data-cookbooks/sips-workflow.md","mtime":"2018-08-07T17:44:09.618Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-08-07T18:16:49.236Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

